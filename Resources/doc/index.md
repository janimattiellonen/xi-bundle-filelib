Getting Started With XiBundleFilelib
====================================

The XiBundleFilelib bundle allows you to use [XiFilelib](https://github.com/xi-project/xi-filelib) in a Symfony2 project.

## Installation

### 1. Install dependencies


Add the following lines to your composer.json file:

* "xi/filelib": "0.11.*"
* "xi/filelib-bundle": "0.11.*"

then run

`php composer.phar update`

Add

`new \Xi\Bundle\FilelibBundle\XiFilelibBundle()`

to AppKernel.php

### 2. Create required directories

* app/data/files
* app/data/temp
* web/files

### 3. Set proper file permissions

* `sudo chown -R www-data:www-data app/data/files`
* `sudo chown -R www-data:www-data app/data/temp`
* `sudo chown -R www-data:www-data web/files`
* `sudo chmod -R ug+rw app/data/files`
* `sudo chmod -R ug+rw app/data/temp`
* `sudo chmod -R ug+rw web/files`

Replace www-data with whatever user/group you want to use.

### 4. Routing

Add

```
xi_filelib:
    resource: "@XiFilelibBundle/Resources/config/routing.yml"
    prefix: /
```
to app/config/routing.yml

### 5. Create Database tables

XiFilelibBundle currently support:

* MariaDB/Mysql
* PostgreSQL
* sqlite

Currently there are no tools for this and you must generate them yourself.

You can find the schemas in vendor/xi/filelib/docs.

## Configuration

[XiFilelib](https://github.com/xi-project/xi-filelib) is highly configurable and with XiBundleFilelib the settings are easily configurable through `app/config/config.yml`.

In more advanced situations you can also override custom implementations with your own.

## Usage

### Backend

The controller `FileController` provides a simple mechanism to render paths to specified file.

The heart of Filelib is its class Xi\Filelib\FileLibrary which should, by default, be used as an access point.

#### Uploading files

Use `Filelib::uploadFile(string|Xi\Filelib\File\Upload\FileUpload)` to upload files. For default functionality, only the file is required.

### Templates

XiBundleFilelib provides a couple of Twig functions for easy access to images and files.

* filelib_file
* filelib_url - direct path to file - requires that the file is available for public download
* filelib_render - path generated by backend - useful if you wish to apply authentication
* filelib_is_file_completed - useful for checking whether an asynchronously uploaded file is ready for use

Each function takes a file of type `Xi\Filelib\File\File`, a version name (default version: 'original') and options).

Examples:

* `{{ filelib_url(file, 'mini') }}`
* `{{ filelib_url(file) }}` using default version name 'original'

## Example

You can use [Xi Filelib Symfony sandbox](https://github.com/xi-project/xi-filelib-symfony-sandbox) for setting up a very simple Symfony 2 project which shows some of the XiBundleFilelib features and use it for further explorations of XiBundleFilelib.